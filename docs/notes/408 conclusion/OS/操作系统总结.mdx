---
title: 📖操作系统总结
sidebar_position: 1
---

## 进程与线程
### 一、进程不能调度的时机
1.进程处于 **操作系统内核[^1]** 临界区

2.进程进入了中断处理程序当中

3.进程位于需要完全屏蔽中断或者其他原子操作当中

> 
>[^1]:这里注意是操作系统内核临界区，如果是普通的临界区是可以主动放弃临界资源然后被调度的，2012-30

### 二、进程允许被调度的时机

1. 进程无法进行下去了（非剥夺调度）
2. 中断处理结束或者trap处理结束但还没有回到用户态的时候 （剥夺调度）

### 三、死锁

### 四、进程间的通信
#### 管道
- 管道是单向的，只能一方写，一方读，不可两方同时写同时读
- 管道的通常为内存的一页，大小不受磁盘限制，受操作系统来管理
- 当管道为空，读进程会被阻塞，当管道满，写进程会被阻塞（读写都可能被阻塞）
- 2014年真题官方答案声称管道可以支持多个写进程写数据，一个读进程读数据，Linux系统支持多个写多个读进程同时访问管道。
- 值得注意，尽管管道支持多写多读，但是这样容易出现混乱，实际操作过程中应该用信号量来互斥使用管道。
#### 死锁产生的四个必要条件

- 互斥条件
- 不剥夺条件
- 请求并保持
- 循环等待

#### 死锁产生的原因

- 系统资源的竞争
- 进程推进顺序非法

安全状态与不安全状态的辨析：

>| 安全状态  | 系统能安装某个推进顺序为每个进程分配资源，使每个进程都能顺利完成 |
>| :------- | ------------------------------------------------------------ |
>| 不安全状态 | 系统无法找到一个安全序列，称系统处于不安全状态               |


- 系统处于安全状态，一定无死锁
- 系统处于不安全状态，**不一定**出现死锁
### 死锁的三种处理对策辨析
#### 死锁预防
![](https://skywalkerch-1303839378.cos.ap-nanjing.myqcloud.com/202311030022452.svg)

#### 死锁避免
![](https://skywalkerch-1303839378.cos.ap-nanjing.myqcloud.com/202311030023509.svg)

#### 死锁检测
![](https://skywalkerch-1303839378.cos.ap-nanjing.myqcloud.com/202311030023475.svg)



### 三、处理机（进程）调度的时机

1. 进程结束时可以进行处理机调度
2. 创建新进程之后可以进行处理机调度
3. 系统调用完成返回用户态的时候可以处理机调度

## 磁盘管理
### 磁盘格式化

- 第一步**<font color=#008000>低级格式化（物理格式化）</font>**：磁盘出厂，厂家将盘面的各个磁道分成不同的扇区，扇区内存有一些和磁盘控制器需要用到的数据结构（校验位等）
- 第二步**<font color=#008000>分区</font>**：操作系统将 多个的柱面组合成一个分区，如C盘，D盘。**分区**不属于逻辑格式化。
- 第三步**<font color=#008000>逻辑格式化（高级格式化）</font>**：高级格式化包括对**主引导记录中分区表相应区域的重写**、根据用户选定的文件系统，在分区中划出一片用于存放 文件分配表 FAT、目录表FCT等用于文件管理的磁盘空间，以便用户使用该分区管理文件。；此外，OS还在磁盘建立了一个**初始为空的文件目录**。

### 操作系统引导

![操作系统引导过程](https://skywalkerch-1303839378.cos.ap-nanjing.myqcloud.com/202311062332758.svg)

- 启动电源
- BIOS固件进行自检
- BIOS固件加载引导扇区（主引导记录MBR）
- MBR开始读取硬盘分区表DPT，找到激活分区，然后找到激活分区中的分区引导记录PBR（partition boot record）（PBR的目的是寻找激活分区根目录下的NTLDR（XP）、bootmgr（Win7 above）、grldr（Grub）、btldr.mbr（BootLink）等可用于引导的程序。），并且把控制权交给PBR.
- PBR搜索活动区中的启动管理器bootmgr，找到后，PBR把控制权交给bootmgr。
- bootmgr寻找活动分区中的boot文件夹中的BCD文件（启动配置数据，相当于xp里的boot.ini文件）。
- 找到BCD后，bootmgr首先从BCD 中读取启动管理器bootmgr菜单的语言版本信息，然后再调用BOOTMGR与相应语言的BOOTMGR.EXE.MUI （在boot文件夹对应语言文件夹中）组成相应语言的启动菜单，之后在显示器上显示多操作系统选择画面。
- 选择操作系统内核并进入操作系统。



